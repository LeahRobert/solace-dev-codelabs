
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>Integrating AWS Bedrock with Solace Agent Mesh</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/claat-public/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14" ga4id=""></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  codelab-ga4id=""
                  id="aws-bedrock-solace-agent-mesh"
                  title="Integrating AWS Bedrock with Solace Agent Mesh"
                  environment="web"
                  feedback-link="https://github.com/SolaceDev/solace-dev-codelabs/blob/master/markdown/aws-bedrock-solace-agent-mesh">
    
      <google-codelab-step label="What you&#39;ll learn: Overview" duration="2">
        <p>In this codelab, you&#39;ll learn how to integrate AWS Bedrock with Solace Agent Mesh to create powerful, event-driven AI agent systems. You&#39;ll explore the configuration, setup, and best practices for connecting AWS Bedrock&#39;s language models to Solace Agent Mesh&#39;s distributed agent framework.</p>
<p>As stated in the Getting started with Solace Agent Mesh codelab, the Solace Agent Mesh provides a universal agent host that enables scalable, distributed AI agent communication through Solace PubSub+. This codelab will build on that knowledge and show you specifically how to leverage AWS Bedrock models within this architecture.</p>
<p>By the end of this codelab, you&#39;ll understand how to:</p>
<ul>
<li>Configure AWS Bedrock as a provider in Solace Agent Mesh</li>
<li>Set up authentication and secure access to AWS Bedrock models</li>
<li>Create and deploy agents using AWS Bedrock models</li>
<li>Build multi-agent systems with AWS Bedrock and other providers</li>
<li>Optimize your AWS Bedrock integration for performance and cost</li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Introduction to AWS Bedrock in Agent Mesh" duration="7">
        <h2 is-upgraded>What is AWS Bedrock?</h2>
<p>AWS Bedrock is a fully managed service that offers a choice of high-performing foundation models (FMs) from leading AI companies through a unified API. With AWS Bedrock, you can access models from companies like Anthropic, AI21 Labs, Cohere, Meta, Stability AI, and Amazon to power generative AI applications securely and privately.</p>
<h2 is-upgraded>Why Integrate AWS Bedrock with Solace Agent Mesh?</h2>
<p>Integrating AWS Bedrock with Solace Agent Mesh allows you to combine the power of AWS&#39;s foundation models with Solace&#39;s event-driven architecture for AI agents.</p>
<aside class="special"><p> By integrating AWS Bedrock with Solace Agent Mesh, you gain access to leading foundation models while leveraging Solace&#39;s enterprise-grade event mesh for reliable, scalable, and secure agent communication.</p>
</aside>
<aside class="warning"><p> Without proper integration, you might struggle with authentication, rate limiting, and efficient communication between your agents and AWS Bedrock services, leading to latency issues and higher costs.</p>
</aside>
<h2 is-upgraded>Integration Architecture</h2>
<p>The integration between AWS Bedrock and Solace Agent Mesh follows this high-level architecture:</p>
<ol type="1">
<li><strong>Solace Agent Mesh</strong> provides the distributed communication framework</li>
<li><strong>AWS Bedrock Provider</strong> acts as the bridge to AWS services</li>
<li><strong>Agent Definitions</strong> specify which AWS Bedrock models to use</li>
<li><strong>Events</strong> trigger agents, which process tasks using AWS Bedrock models</li>
<li><strong>Results</strong> flow back through the event mesh to gateways or other agents</li>
</ol>


      </google-codelab-step>
    
      <google-codelab-step label="Setting Up AWS Bedrock Integration" duration="15">
        <p>To integrate AWS Bedrock with Solace Agent Mesh, you need to set up authentication and configure the Bedrock provider. This section will guide you through the process step by step.</p>
<h2 is-upgraded>Prerequisites</h2>
<p>Before you begin, ensure you have:</p>
<ol type="1">
<li>Installed Solace Agent Mesh CLI (as described in the Getting started with Solace Agent Mesh codelab)</li>
<li>An AWS account with access to AWS Bedrock</li>
<li>AWS Bedrock model access (you may need to request access to specific models)</li>
<li>AWS credentials with appropriate permissions</li>
</ol>
<h2 is-upgraded>Step 1: Configure AWS Credentials</h2>
<p>First, you need to set up your AWS credentials. You can do this using environment variables or AWS configuration files:</p>
<pre><code language="language-bash" class="language-bash"># Using environment variables
export AWS_ACCESS_KEY_ID=your_access_key
export AWS_SECRET_ACCESS_KEY=your_secret_key
export AWS_REGION=us-east-1
</code></pre>
<p>Or by configuring the AWS CLI:</p>
<pre><code language="language-bash" class="language-bash">aws configure
</code></pre>
<aside class="special"><p> Using environment variables or the AWS configuration file allows Solace Agent Mesh to authenticate with AWS services securely without hardcoding credentials.</p>
</aside>
<h2 is-upgraded>Step 2: Configure the AWS Bedrock Provider</h2>
<p>Create or update your Solace Agent Mesh configuration to include the AWS Bedrock provider. This is typically done in the <code>shared_config.yaml</code> file:</p>
<pre><code language="language-yaml" class="language-yaml">providers:
  - name: bedrock
    type: aws_bedrock
    config:
      region: us-east-1
      credentials:
        # Use environment variables or IAM roles for production
        access_key_id: ${AWS_ACCESS_KEY_ID}
        secret_access_key: ${AWS_SECRET_ACCESS_KEY}
      models:
        - name: claude-v2
          model_id: anthropic.claude-v2
        - name: claude-3-sonnet
          model_id: anthropic.claude-3-sonnet-20240229-v1:0
        - name: titan
          model_id: amazon.titan-text-express-v1
</code></pre>
<aside class="warning"><p> Never commit credentials directly in configuration files. Always use environment variables, AWS IAM roles, or secure secret management solutions.</p>
</aside>
<h2 is-upgraded>Step 3: Test the Connection</h2>
<p>Verify that your configuration works by running a test:</p>
<pre><code language="language-bash" class="language-bash">solace-agent-mesh test-provider bedrock
</code></pre>
<p>This command will attempt to connect to AWS Bedrock using your configuration and report any issues.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Creating Agents with AWS Bedrock Models" duration="10">
        <p>Now that you&#39;ve configured the AWS Bedrock provider, let&#39;s create agents that use these models.</p>
<h2 is-upgraded>Basic Agent Configuration</h2>
<p>Create a new agent configuration file in your <code>configs/agents</code> directory:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/agents/bedrock-assistant.yaml
name: bedrock-assistant
description: &#34;A helpful assistant powered by AWS Bedrock&#34;
provider: bedrock
model: claude-v2
system_prompt: |
  You are a helpful assistant. Provide clear and concise responses to user questions.
  When you don&#39;t know something, admit it rather than making up information.
tools:
  - tool_type: builtin
    tool_name: &#34;status&#34;
</code></pre>
<h2 is-upgraded>Advanced Configuration Options</h2>
<p>AWS Bedrock models support various parameters to control the response:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/agents/bedrock-expert.yaml
name: bedrock-expert
description: &#34;An expert assistant powered by AWS Bedrock Claude 3 Sonnet&#34;
provider: bedrock
model: claude-3-sonnet
parameters:
  temperature: 0.7
  top_p: 0.9
  max_tokens: 1000
system_prompt: |
  You are an expert assistant specializing in technical support.
  Provide detailed, accurate information when responding to queries.
tools:
  - tool_type: builtin
    tool_name: &#34;search&#34;
  - tool_type: builtin
    tool_name: &#34;calculator&#34;
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Using AWS Bedrock Agents in Multi-Agent Systems" duration="5">
        <p>Solace Agent Mesh excels at orchestrating multiple agents. Let&#39;s see how to use AWS Bedrock models alongside other model providers in a multi-agent system.</p>
<h2 is-upgraded>Creating a Multi-Model System</h2>
<p>You can create a system with different agents using various models from AWS Bedrock and other providers:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/agents/orchestrator.yaml
name: orchestrator
description: &#34;Orchestrator agent that coordinates tasks&#34;
provider: openai
model: gpt-4
system_prompt: |
  You are an orchestrator agent. Your job is to coordinate tasks between specialized agents.
  Analyze each request and determine which agent is best suited to handle it.
tools:
  - tool_type: agent
    agent_name: &#34;bedrock-assistant&#34;
  - tool_type: agent
    agent_name: &#34;bedrock-expert&#34;
  - tool_type: agent
    agent_name: &#34;image-generator&#34;
</code></pre>
<aside class="special"><p> As per the Getting started with Solace Agent Mesh codelab, this multi-agent approach allows you to leverage the strengths of different models for different tasks, creating a more powerful and flexible system.</p>
</aside>
<h2 is-upgraded>Event-Driven Agent Communication</h2>
<p>With Solace Agent Mesh, agents can communicate via events:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/gateways/bedrock-gateway.yaml
name: bedrock-gateway
type: http
config:
  port: 8080
  host: &#34;0.0.0.0&#34;
  agent: orchestrator
  auth:
    type: none
</code></pre>
<p>This configuration enables HTTP-based interaction with your multi-agent system.</p>


      </google-codelab-step>
    
      <google-codelab-step label="Performance Optimization and Best Practices" duration="7">
        <p>To get the most out of your AWS Bedrock integration with Solace Agent Mesh, follow these best practices:</p>
<h2 is-upgraded>Model Selection</h2>
<p>AWS Bedrock offers various models with different capabilities and price points:</p>
<pre><code language="language-yaml" class="language-yaml"># Example of different model configurations
providers:
  - name: bedrock
    type: aws_bedrock
    config:
      region: us-east-1
      models:
        # Cost-effective for simple tasks
        - name: titan
          model_id: amazon.titan-text-express-v1
        # Balanced performance and cost
        - name: claude-instant
          model_id: anthropic.claude-instant-v1
        # High performance for complex reasoning
        - name: claude-3-sonnet
          model_id: anthropic.claude-3-sonnet-20240229-v1:0
</code></pre>
<aside class="special"><p> Choose the appropriate model based on your task complexity, performance requirements, and budget. Simpler models can handle basic tasks at lower cost, while advanced models excel at complex reasoning.</p>
</aside>
<h2 is-upgraded>Caching and Rate Limiting</h2>
<p>Implement caching and rate limiting to optimize costs and performance:</p>
<pre><code language="language-yaml" class="language-yaml">providers:
  - name: bedrock
    type: aws_bedrock
    config:
      region: us-east-1
      rate_limit: 10  # requests per second
      cache:
        enabled: true
        ttl_seconds: 3600
      models:
        - name: claude-v2
          model_id: anthropic.claude-v2
</code></pre>
<h2 is-upgraded>Monitoring AWS Bedrock Usage</h2>
<p>Set up monitoring for your AWS Bedrock usage:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/shared_config.yaml
monitoring:
  enabled: true
  metrics:
    - type: aws_cloudwatch
      config:
        namespace: &#34;SolaceAgentMesh&#34;
        dimensions:
          - name: &#34;Provider&#34;
            value: &#34;AWS_Bedrock&#34;
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Security Considerations" duration="5">
        <p>Security is crucial when working with AI services and sensitive data.</p>
<h2 is-upgraded>Secure Authentication</h2>
<p>Use IAM roles for EC2 or Lambda deployments:</p>
<pre><code language="language-yaml" class="language-yaml">providers:
  - name: bedrock
    type: aws_bedrock
    config:
      region: us-east-1
      credentials:
        type: iam_role  # Uses the IAM role attached to the EC2/Lambda
      models:
        - name: claude-v2
          model_id: anthropic.claude-v2
</code></pre>
<h2 is-upgraded>Data Privacy</h2>
<aside class="warning"><p> AWS Bedrock may store and use your prompts and completions to improve their models unless you opt out. Review AWS&#39;s data handling policies and configure your integration accordingly.</p>
</aside>
<p>To enhance data privacy:</p>
<pre><code language="language-yaml" class="language-yaml">providers:
  - name: bedrock
    type: aws_bedrock
    config:
      region: us-east-1
      privacy:
        opt_out_data_use: true
      models:
        - name: claude-v2
          model_id: anthropic.claude-v2
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Testing and Deployment" duration="10">
        <p>After configuring your agents, it&#39;s time to test and deploy your solution.</p>
<h2 is-upgraded>Testing Locally</h2>
<p>Run your agent mesh locally for testing:</p>
<pre><code language="language-bash" class="language-bash"># Start the mesh with your configuration
solace-agent-mesh start

# In another terminal, test an agent
curl -X POST http://localhost:8080/query \
  -H &#34;Content-Type: application/json&#34; \
  -d &#39;{&#34;query&#34;: &#34;Tell me about event-driven architectures&#34;, &#34;agent&#34;: &#34;bedrock-assistant&#34;}&#39;
</code></pre>
<h2 is-upgraded>Containerized Deployment</h2>
<p>For production, containerize your deployment:</p>
<pre><code language="language-bash" class="language-bash"># Build a Docker image
solace-agent-mesh build-docker

# Run the containerized agent mesh
docker run -p 8080:8080 \
  -e AWS_ACCESS_KEY_ID \
  -e AWS_SECRET_ACCESS_KEY \
  -e AWS_REGION \
  solace-agent-mesh:latest
</code></pre>
<h2 is-upgraded>Scaling with Kubernetes</h2>
<p>For large-scale deployments, use Kubernetes:</p>
<pre><code language="language-yaml" class="language-yaml"># kubernetes/deployment.yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: solace-agent-mesh
spec:
  replicas: 3
  selector:
    matchLabels:
      app: solace-agent-mesh
  template:
    metadata:
      labels:
        app: solace-agent-mesh
    spec:
      containers:
      - name: solace-agent-mesh
        image: solace-agent-mesh:latest
        ports:
        - containerPort: 8080
        env:
        - name: AWS_REGION
          value: &#34;us-east-1&#34;
        # Use Kubernetes secrets for credentials
</code></pre>


      </google-codelab-step>
    
      <google-codelab-step label="Advanced Use Cases" duration="5">
        <p>AWS Bedrock with Solace Agent Mesh enables sophisticated use cases:</p>
<h2 is-upgraded>Document Processing Pipeline</h2>
<p>Create a document processing pipeline with specialized agents:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/agents/document-processor.yaml
name: document-processor
description: &#34;Processes and analyzes documents&#34;
provider: bedrock
model: claude-3-sonnet
system_prompt: |
  You are a document processing specialist. Extract key information from documents,
  analyze their content, and provide summaries.
tools:
  - tool_type: builtin
    tool_name: &#34;file_reader&#34;
  - tool_type: builtin
    tool_name: &#34;text_extractor&#34;
  - tool_type: agent
    agent_name: &#34;summary-generator&#34;
</code></pre>
<h2 is-upgraded>Question-Answering over Enterprise Data</h2>
<p>Build a system that answers questions using enterprise data:</p>
<pre><code language="language-yaml" class="language-yaml"># configs/agents/data-analyst.yaml
name: data-analyst
description: &#34;Analyzes enterprise data and answers questions&#34;
provider: bedrock
model: claude-v2
system_prompt: |
  You are a data analyst with access to enterprise data sources.
  Answer questions accurately using only the data provided.
tools:
  - tool_type: builtin
    tool_name: &#34;database_query&#34;
  - tool_type: builtin
    tool_name: &#34;data_visualizer&#34;
</code></pre>
<aside class="special"><p> By integrating AWS Bedrock with Solace Agent Mesh as described in this codelab, you can create sophisticated AI systems that leverage the full power of event-driven architectures and state-of-the-art language models.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Next Steps" duration="5">
        <p>Now that you&#39;ve learned how to integrate AWS Bedrock with Solace Agent Mesh, consider these next steps:</p>
<ol type="1">
<li><strong>Explore other AWS AI services</strong> - Consider integrating other AWS AI services like Amazon Rekognition or Amazon Comprehend</li>
<li><strong>Build custom tools</strong> - Create domain-specific tools for your agents</li>
<li><strong>Implement feedback loops</strong> - Use human feedback to improve your agents over time</li>
<li><strong>Explore multi-model strategies</strong> - Implement strategies to leverage different models for different tasks</li>
<li><strong>Optimize for cost and performance</strong> - Fine-tune your implementation for your specific use cases</li>
</ol>
<aside class="special"><p> As you become more familiar with Solace Agent Mesh, you&#39;ll discover additional ways to leverage AWS Bedrock&#39;s capabilities within your agent ecosystem.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Takeaways" duration="7">
        <p>In this codelab, you&#39;ve learned how to:</p>
<ul>
<li>Configure AWS Bedrock as a provider in Solace Agent Mesh</li>
<li>Set up secure authentication between Solace Agent Mesh and AWS Bedrock</li>
<li>Create agents that leverage AWS Bedrock models</li>
<li>Build multi-agent systems with AWS Bedrock and other providers</li>
<li>Optimize your implementation for performance, cost, and security</li>
<li>Deploy your solution in different environments</li>
</ul>
<p>By integrating AWS Bedrock with Solace Agent Mesh, you&#39;ve created a powerful platform for building sophisticated AI applications that can process events, communicate with other systems, and provide valuable insights.</p>
<aside class="special"><p> Remember that the event-driven architecture of Solace Agent Mesh, as highlighted in the Getting started with Solace Agent Mesh codelab, provides a flexible foundation for expanding your AI capabilities as your needs evolve.</p>
</aside>
<p>We hope this codelab has given you a solid foundation for integrating AWS Bedrock with Solace Agent Mesh. As you continue to explore this technology, you&#39;ll discover even more ways to leverage the power of event-driven AI agents in your applications.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/claat-public/native-shim.js"></script>
  <script src="https://storage.googleapis.com/claat-public/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/claat-public/prettify.js"></script>
  <script src="https://storage.googleapis.com/claat-public/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
